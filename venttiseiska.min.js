/*!
 * @license
 * Venttiseiska v0.1.0-beta
 * https://github.com/niklasramo/venttiseiska
 * Copyright (c) 2016 Niklas Rämö <inramo@gmail.com>
 * Released under the MIT license
 */
!function(t,e){var n="Venttiseiska";"function"==typeof define&&define.amd?define(n,[],function(){return e(t)}):"object"==typeof module&&module.exports?module.exports=e(t):t[n]=e(t)}("object"==typeof window&&window.window||this,function(t,e){"use strict";function n(){_?p.set(this,{}):this._listeners={}}function i(t){return"string"==typeof t?t.split(l):t}function r(t,e){t=i(t);for(var n=0,r=t.length;r>n;n++){var o=t[n].split(h),s=o.shift();s&&e(s,o)}}function o(t){return"object"==typeof t&&null!==t&&"[object Object]"===Object.prototype.toString.call(t)}function s(t,e){for(var n=0,i=t.length;i>n;n++)if(e.indexOf(t[n])<0)return!1;return!0}function f(t){var e=[],n=v?new v:Object.create(null),i=t.length;if(v)for(;i--;)n.has(t[i])||(n.add(t[i]),e.push(t[i]));else for(;i--;){var r=t[i],o=_?p.get(r)._id:r._id;n[o]||(n[o]=1,e.push(r))}return e}function c(t,e){var n=_?p.get(t)._id:t._id,i=_?p.get(e)._id:e._id;return i>n?-1:n>i?1:0}function a(e){var n=t.Symbol;return e&&"function"==typeof n&&"function"==typeof n.toString&&n(e).toString().indexOf("[native code]")>-1&&e}var u=0,l=" ",h=":",g=n.prototype,v=a(t.WeakSet),_=a(t.WeakMap),p=_?new _:null;return g.on=function(t,e,i){var s,f=this,c=[];return o(t)&&(s=t.cycles,i=t.context,e=t.listener,t=t.events),r(t,function(t,r){c.push(new n.Listener(f,t,e,r,i,s))}),c},g.once=function(t,e,n){var i=o(t)?t:{events:t,listener:e,context:n};return i.cycles=1,this.on(i)},g.off=function(t,e){var n=_?p.get(this):this._listeners;if(t){var i="number"==typeof e,o="function"==typeof e;r(t,function(t,r){var f=n[t],c=r.length,a=f?f.length:0;if(a)if(e||c)for(;a--;){var u=_?p.get(f[a]):f[a];c&&!s(r,u._tags)||!(!e||o&&e===u._fn||i&&e===u._id)||(u._bound=!1,f.splice(a,1))}else{for(;a--;)(_?p.get(f[a]):f[a])._bound=!1;f.length=0}})}else for(var f=0,c=Object.keys(n),a=c.length;a>f;f++){for(var u=n[c[f]],l=u?u.length:0;l--;)(_?p.get(u[l]):u[l])._bound=!1;u.length=0}},g.emit=function(t,e,n){var r=_?p.get(this):this._listeners,o=arguments.length>1;t=i(t);for(var f=0,c=t.length;c>f;f++){var a=t[f].split(h),u=a.shift();if(u){var l=r[u],g=l&&l.length,v=a.length;if(g)for(var d=0;g>d;d++){var y=l[d];(!v||s(a,(_?p.get(y):y)._tags))&&(o?y.emit(e,n):y.emit(e))}}}},g.getEvents=function(){for(var t=_?p.get(this):this._listeners,e=[],n=0,i=Object.keys(t),r=i.length;r>n;n++)t[i[n]]&&t[i[n]].length>0&&e.push(i[n]);return e},g.getListeners=function(t){var e=_?p.get(this):this._listeners,n=[],i=0;return t=t||this.getEvents(),r(t,function(t,r){++i;var o=e[t],f=o.length;if(f)if(r.length)for(var c=0;f>c;c++){var a=o[c],u=_?p.get(a):a;s(r,u._tags)&&n.push(a)}else n=n.concat(e[t])}),i>1&&n.length>1?f(n).sort(c):n},n.Listener=function(t,e,i,r,o,s){t instanceof n||(e=t.event,i=t.fn,r=t.tags,o=t.context,s=t.cycles,t=t.emitter);var f={_id:++u,_emitter:t,_event:e,_fn:i,_tags:(r||[]).concat(),_context:o,_cycles:s||0,_active:!0,_bound:!0};if(_)p.set(this,f);else for(var c=0,a=Object.keys(f),l=a.length;l>c;c++)this[a[c]]=f[a[c]];var h=_?p.get(t):t._listeners;(h[e]=h[e]||[]).push(this)},n.Listener.prototype.off=function(){var t=_?p.get(this):this;return t._bound&&t._emitter.off(t._event,t._id),this},n.Listener.prototype.emit=function(t,e){var n=_?p.get(this):this;if(n._bound&&n._active){var i=n._fn,r=arguments.length>1?e:n._context,o=t?t.length:0;void 0===r&&6>o?o?1==o?i(t[0]):2==o?i(t[0],t[1]):3==o?i(t[0],t[1],t[2]):4==o?i(t[0],t[1],t[2],t[3]):i(t[0],t[1],t[2],t[3],t[4]):i():o?i.apply(r,t.concat()):i.call(r),n._cycles&&0===--n._cycles&&this.off()}return this},n.Listener.prototype.update=function(t){if(t&&o(t)){var e=_?p.get(this):this;if(e._bound)for(var n=["fn","tags","context","cycles","active"],i=0;5>i;i++){var r=n[i];t.hasOwnProperty(r)&&t[r]!==e["_"+r]&&(e["_"+r]=t[r])}}return this},n.Listener.prototype.inspect=function(){var t=_?p.get(this):this;return{id:t._id,emitter:t._emitter,event:t._event,fn:t._fn,tags:t._tags.concat(),context:t._context,cycles:t._cycles,active:t._active,bound:t._bound}},n});